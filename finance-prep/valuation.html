<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Valuation | IB Reference</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { 
            --bg-color:#ffffff; 
            --text-primary:#111827; 
            --text-secondary:#374151; 
            --text-tertiary:#6b7280; 
            --accent-blue:#1e3a8a; 
            --accent-gold:#b45309; 
            --border-light:#e5e7eb;
            --code-bg:#f3f4f6;
        }
        *{margin:0;padding:0;box-sizing:border-box;-webkit-font-smoothing:antialiased}
        body{background-color:var(--bg-color);color:var(--text-primary);font-family:'Merriweather', serif;line-height:1.8;max-width:900px;margin:0 auto;padding:60px 24px;font-size:16px}
        
        h1{font-family:'Inter', sans-serif; font-size:42px; font-weight:800; letter-spacing:-1px; margin-bottom:10px; color:var(--accent-blue); line-height:1.2;}
        .subtitle{font-family:'Inter', sans-serif; font-size:18px; color:var(--text-tertiary); margin-bottom:60px; font-weight:400; border-bottom:1px solid var(--border-light); padding-bottom:20px;}
        
        h2{font-family:'Inter', sans-serif; font-size:28px; font-weight:700; margin-top:60px; margin-bottom:20px; color:var(--accent-blue); border-left:4px solid var(--accent-gold); padding-left:16px;}
        h3{font-family:'Inter', sans-serif; font-size:20px; font-weight:600; margin-top:40px; margin-bottom:12px; color:var(--text-primary);}
        
        p{margin-bottom:24px; color:var(--text-secondary);}
        strong{color:var(--text-primary); font-weight:700;}
        
        .nav-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:40px; font-family:'Inter',sans-serif; font-size:14px;}
        .nav-link{text-decoration:none; color:var(--text-tertiary); transition:color 0.2s; display:flex; align-items:center; gap:8px;}
        .nav-link:hover{color:var(--accent-blue);}

        .toc-box{background:#f9fafb; border:1px solid var(--border-light); padding:30px; margin-bottom:60px; border-radius:4px;}
        .toc-header{font-family:'Inter',sans-serif; font-weight:700; text-transform:uppercase; font-size:12px; letter-spacing:1px; color:var(--text-tertiary); margin-bottom:16px;}
        .toc-list{list-style:none; column-count:2; column-gap:40px;}
        .toc-list li{margin-bottom:10px;}
        .toc-list a{text-decoration:none; color:var(--text-secondary); font-family:'Inter',sans-serif; font-size:14px; font-weight:500; transition:color 0.2s;}
        .toc-list a:hover{color:var(--accent-gold); text-decoration:underline;}

        .concept-box{background:#fff; border:1px solid var(--border-light); border-top:3px solid var(--accent-blue); padding:24px; margin:32px 0; box-shadow:0 4px 6px -1px rgba(0,0,0,0.05);}
        .concept-title{font-family:'Inter',sans-serif; font-weight:700; font-size:14px; text-transform:uppercase; letter-spacing:0.5px; color:var(--accent-blue); margin-bottom:12px; display:block;}
        
        .math-block{font-family:'JetBrains Mono', monospace; background:var(--code-bg); padding:16px; border-radius:4px; font-size:14px; color:#374151; overflow-x:auto; border-left:4px solid #d1d5db; margin-bottom:24px;}
        
        .eng-note{background:#eff6ff; border-left:4px solid #3b82f6; padding:20px; font-size:15px; color:#1e40af; margin-top:40px;}
        .eng-title{font-weight:700; font-family:'Inter',sans-serif; margin-bottom:8px; display:block; text-transform:uppercase; font-size:12px; letter-spacing:1px;}
    </style>
</head>
<body>

    <div class="nav-header">
        <a href="index.html" class="nav-link"><i class="fa-solid fa-arrow-left"></i> Return to Index</a>
        <span style="color:var(--text-tertiary)">Advanced Valuation Theory</span>
    </div>

    <h1>Valuation Methodologies</h1>
    <div class="subtitle">A theoretical and computational framework for intrinsic (DCF) and relative (Comps) valuation, including stochastic modeling.</div>

    <div class="toc-box">
        <div class="toc-header">Table of Contents</div>
        <ul class="toc-list">
            <li><a href="#dcf-theory">1. DCF Theory & Derivation</a></li>
            <li><a href="#mid-year">2. Mid-Year Convention</a></li>
            <li><a href="#wacc">3. WACC & Beta Mechanics</a></li>
            <li><a href="#terminal">4. Terminal Value Math</a></li>
            <li><a href="#comps">5. Relative Valuation Logic</a></li>
            <li><a href="#engineering">6. Engineering: Monte Carlo DCF</a></li>
        </ul>
    </div>

    <!-- 1. DCF Theory -->
    <section id="dcf-theory">
        <h2>1. The Discounted Cash Flow (DCF) Theorem</h2>
        <p>The fundamental axiom of finance states that the value of an asset is the present value of its future expected cash flows.</p>

        <div class="math-block">
            Value = &Sigma; [ FCF<span class="sub">t</span> / (1 + WACC)<sup>t</sup> ]
        </div>

        <p>Why do we use <strong>Unlevered Free Cash Flow (UFCF)</strong>? Because we want to value the <em>operations</em> of the business (Enterprise Value), independent of its capital structure (Debt vs Equity). We are assessing the engine, not how the car was financed.</p>

        <div class="concept-box">
            <span class="concept-title">Derivation of UFCF</span>
            <div class="math-block">
                EBIT * (1 - Tax_Rate)   <span style="color:#6b7280">// NOPAT (Net Operating Profit After Tax)</span><br>
                + Depreciation & Amortization <span style="color:#6b7280">// Non-cash add-back</span><br>
                - Change in Net Working Capital <span style="color:#6b7280">// Cash trapped in operations</span><br>
                - Capital Expenditures (CapEx)  <span style="color:#6b7280">// Reinvestment needed to grow</span><br>
                = <strong>Unlevered Free Cash Flow</strong>
            </div>
        </div>
    </section>

    <!-- 2. Mid-Year Convention -->
    <section id="mid-year">
        <h2>2. Mid-Year Convention: The Integral Approach</h2>
        <p>Standard DCF assumes cash flows arrive at $t=1, 2, 3...$ (December 31st). In reality, revenue is earned continuously throughout the year ($t=0.5, 1.5, 2.5...$).</p>
        <p>Without this adjustment, we discount cash flows too aggressively (by an extra 6 months on average), understating the valuation.</p>

        <div class="math-block">
            Discount_Factor_Standard = 1 / (1 + WACC)<sup>t</sup><br>
            Discount_Factor_MidYear = 1 / (1 + WACC)<sup>t - 0.5</sup>
        </div>

        <p>Mathematically, this approximates the integral of the continuous cash flow function $f(t) * e^{-rt} dt$.</p>
    </section>

    <!-- 3. WACC -->
    <section id="wacc">
        <h2>3. WACC & Beta Re-levering Mechanics</h2>
        <p>WACC (Weighted Average Cost of Capital) represents the opportunity cost of investing in this specific asset class.</p>

        <h3>The Beta Problem</h3>
        <p>You cannot simply average the Betas of peer companies. Beta measures volatility, and debt increases volatility (financial leverage). To compare "Apples to Apples", we must strip out the debt effect (Unlever) and then put our target's debt effect back in (Relever).</p>

        <div class="math-block">
            <strong>Step 1: Unlever Peer Beta</strong><br>
            &beta;<span class="sub">Asset</span> = &beta;<span class="sub">Equity</span> / [1 + (1 - Tax) * (Debt/Equity)]<br><br>
            <strong>Step 2: Relever for Target</strong><br>
            &beta;<span class="sub">Target</span> = &beta;<span class="sub">Asset_Avg</span> * [1 + (1 - Tax) * (Target_Debt/Equity)]
        </div>
    </section>

    <!-- 4. Terminal Value -->
    <section id="terminal">
        <h2>4. Terminal Value: Infinite Geometric Series</h2>
        <p>Since companies are assumed to exist into perpetuity, we must calculate the value from Year 5 to $\infty$. The <strong>Gordon Growth Model</strong> is derived from the sum of an infinite geometric series.</p>

        <div class="math-block">
            Sum = a / (1 - r)  <span style="color:#6b7280">// Standard Geometric Series Formula</span><br>
            <br>
            TV = [ FCF<span class="sub">Final</span> * (1 + g) ] / (WACC - g)
        </div>

        <p><strong>Constraints:</strong> $g$ (Growth Rate) cannot exceed the GDP growth rate (otherwise the company would eventually become larger than the entire economy). Typically 2-3%.</p>
    </section>

    <!-- 5. Relative Valuation -->
    <section id="comps">
        <h2>5. Relative Valuation (Comps)</h2>
        <p>Valuation by analogy. If a similar house sold for $100/sqft, this house is worth $100/sqft.</p>
        
        <div class="concept-box">
            <span class="concept-title">Why EV/EBITDA and not P/E?</span>
            <p><strong>P/E</strong> is affected by capital structure (Interest Expense) and tax jurisdictions. <strong>EV/EBITDA</strong> is capital structure neutral and tax neutral. It allows for a pure operational comparison between companies in different countries with different debt loads.</p>
        </div>
    </section>

    <!-- 6. Engineering Perspective -->
    <section id="engineering">
        <h2>6. Engineering Perspective: Stochastic DCF</h2>
        <div class="eng-note">
            <span class="eng-title">From Deterministic to Probabilistic</span>
            <p>A standard Excel DCF is "Deterministic" (Single Input â†’ Single Output). This is scientifically flawed because inputs (Growth, WACC) are uncertain variables, not constants.</p>
            
            <p style="margin-top:12px"><strong>The Engineer's Solution: Monte Carlo Simulation</strong></p>
            <ul style="margin-left:20px; font-size:14px; margin-top:8px;">
                <li>Define inputs as Probability Distributions (e.g., Growth ~ Normal($\mu=3\%$, $\sigma=0.5\%$)).</li>
                <li>Run 10,000 iterations using Python (`numpy.random`).</li>
                <li>Output is not a number, but a <strong>Probability Density Function (PDF)</strong> of the share price.</li>
            </ul>

            <div class="math-block" style="background:#1e293b; color:#e2e8f0; border-left:4px solid #10b981;">
# Python Pseudo-code for Monte Carlo DCF
import numpy as np

simulations = 10000
growth_rates = np.random.normal(0.03, 0.005, simulations)
wacc_values = np.random.normal(0.09, 0.01, simulations)

valuations = []
for g, wacc in zip(growth_rates, wacc_values):
    tv = final_fcf * (1 + g) / (wacc - g)
    enterprise_value = np.sum(discounted_fcfs) + (tv / (1+wacc)**5)
    valuations.append(enterprise_value)

print(f"95% Confidence Interval: {np.percentile(valuations, [2.5, 97.5])}")
            </div>
            <p>This approach transforms you from a "Spreadsheet Monkey" to a "Financial Modeler".</p>
        </div>
    </section>

</body>
</html>
